/***********************************************
socialmix   1.3.2
jQuery Socialmix Timeline 
Copyright (c) Andrea Di Toro 
http://kodiga.com/jquery-socialmix-timeline/ 
***********************************************/
!function(a){"use strict";function b(a){this.g=a,this.h=function(){this.g.h(!0)}}function c(){this.i=e.options.timelineCardMargin+20,this.j=e.options.timelineCardMargin,this.k=e.options.timelineMinWidthTwoCol,this.l=0,this.m="",this.o=function(){var b=a(this).parents(".sm-card-header").find(".sm-share-box");return b.hasClass("sm-open-share-box")?b.removeClass("sm-open-share-box"):(h.p(),b.addClass("sm-open-share-box")),!1},this.h=function(a){a=a||!1;var b=e.q.outerWidth();if(b===this.l&&!a)return!1;this.l=b;var c;b>this.k&&!e.options.fixOneColumnMode?(c="sm-two-column",this.s(c,this.m)):b<=280?(c="sm-one-column-small",this.t(c,this.m)):b<=400?(c="sm-one-column-noline",this.t(c,this.m)):e.options.oneColumnTimeline?(c="sm-one-column-noline",this.t(c,this.m)):(c="sm-one-column",this.t(c,this.m)),this.m=c},this.t=function(a,b){a!==b&&(e.q.removeClass(b).addClass(a),"sm-two-column"!==b&&""!==b||(e.u.removeAttr("style").removeClass("sm-left-side").addClass("sm-right-side"),e.v.removeAttr("style")));var c=e.u.not(".sm-hidden");if("sm-one-column"===a?c.first().css("margin-top","40px"):c.first().css("margin-top","0px"),e.options.oneColumnHeight){var d={height:e.options.oneColumnHeight,"overflow-y":"scroll"};e.q.css(d)}},this.s=function(b,c){b!==c&&e.q.addClass(b).removeClass(c);var d=e.u.not(".sm-hidden"),f=this.i,g=this.j,h={left:{A:0,B:0},right:{A:0,B:0}},i={left:"right",right:"left"};a.each(d,function(d,e){var j=a(e),k="right";h.left.B<=h.right.B&&(k="left"),b!==c&&j.removeAttr("style");var l=h[k].B+g,m=l-h[i[k]].A;if(m<f){var n=f-m;l+=n}0===d&&(l=50),j.addClass("sm-"+k+"-side").removeClass("sm-"+i[k]+"-side").css("top",l+"px"),h[k]={A:l,B:l+j.height()}});var j=Math.max(h.left.B,h.right.B)+50;e.v.height(j)},e.q.on("click",".sm-btn-share , .sm-share-box a ",this.o),this.h()}function d(){this.l=0,this.margin=e.options.gridCardMargin,this.C=4,this.D=e.options.gridCardMinWidth,this.o=function(){var b=a(this).parents(".sm-card-header").find(".sm-share-box");return b.hasClass("sm-open-share-box")?b.removeClass("sm-open-share-box"):(h.p(),b.addClass("sm-open-share-box")),!1},this.h=function(a){a=a||!1;var b=e.q.outerWidth();if(b===this.l&&!a)return!1;var c=!1;0===this.l&&(c=!0),this.l=b,this.D>b&&(this.D=b);for(var d=this.margin,f=this.C,g=0;g<this.D;)g=b/f-d/f*(f-1),f--;f++,this.F(f,g,d),c&&(e.u.addClass("sm-grid-card"),e.q.addClass("sm-grid-column"))},this.F=function(b,c,d){function f(a,b){for(var c=1/0,d=0,e=0;e<a;e++){if(0===b[e].top)return e;b[e].top<c&&(c=b[e].top,d=e)}return d}for(var g=e.u.not(".sm-hidden"),h=[],i=0;i<b;i++)h[i]={top:0,left:(c+d)*i};var j=0;a.each(g,function(e,g){var i=a(g),k=h[j].top,l=h[j].left;i.css({top:k,left:l,width:c}),h[j].top=k+i.outerHeight()+d,j=f(b,h)});for(var k=0,l=0;l<b;l++)h[l].top>k&&(k=h[l].top);e.v.height(k)},e.q.on("click",".sm-btn-share , .sm-share-box a ",this.o),this.h()}a.fn.socialmix=function(b){return e.G=a(this),e.options=a.extend(a.fn.socialmix.H,b),a.fn.socialmix.I.options=e.options,a.fn.socialmix.I.options.J=h,f=a.fn.socialmix.I,k.K(function(){f.L(),h.L(),g.L()}),this};var e={options:{},G:null,q:null,v:null,M:null,u:null},f={},g={L:function(){this.N()},N:function(){var b=[],c=[];a.each(e.options.feeds,function(d,g){var i,j;if("custom_object"===g.type){var k=window[g.id],l=void 0!==g.tags?g.tags:[];l=h.populateTagList(l);var m=f.O(g,k,l);return void(c=c.concat(m))}j={id:g.id,type:g.type},i=e.options.proxy,g.resources&&(j.resources=g.resources),g.target&&(j.target=g.target),"custom"===g.type&&(i=g.id,j={});var n=a.get(i,j,function(a){var b=void 0!==g.tags?g.tags:[];b=h.populateTagList(b);var d=f.O(g,a,b);c=c.concat(d)}).fail(function(a){a.responseJSON.hasOwnProperty("message")&&console.error(a.responseJSON.message)});b.push(n)}),a.when.apply(a,b).then(function(){g.P(c)}).fail(function(){g.P(c)})},P:function(a){var b={R:-1,S:1},c={R:1,S:-1},d={};d="desc"===e.options.sortCards?b:c,a.sort(function(a,b){return a.systemDate.valueOf()>b.systemDate.valueOf()?d.R:d.S}),e.options.maxCardNumber&&(a=a.slice(0,e.options.maxCardNumber)),h.T(a)}},h={cardTemplate:"",containerTemplate:"",g:null,U:null,V:0,W:0,X:[],Y:[],tags:[],Z:0,$:0,L:function(){var a=Mustache.render(h.containerTemplate,e.options.translate);e.G.append(a),e.q=e.G.find(".sm-container"),e.M=e.G.find(".sm-filter-container"),e.v=e.G.find(".sm-card-container"),h._()},_:function(){a(window).scroll(this.aa),a(window).resize(function(){h.g&&h.g.h(),h.ba()}),e.q.on("click",".sm-scrollToTop",this.ca),e.q.on("click",".sm-goto a",this.goToDate),e.q.on("click",".sm-filter-tag a",{da:".sm-filter-tag",ea:"filterTag"},this.fa),e.q.on("click",".sm-filter-date a",{da:".sm-filter-date",ea:"filterDate"},this.fa),e.q.on("click",".sm-card a.card-filter",{da:".sm-filter-tag",ea:"filterTag"},this.fa),e.q.on("click",".sm-filter-source a",{da:".sm-filter-source",ea:"filterSource"},this.fa),e.q.on("click",this.p),e.q.on("click",".sm-dropdown",this.ga)},showFilters:function(){a(this).hide(),e.M.find(".sm-dropdown").show()},fa:function(b){var c=a(this).attr("value"),d=b.data.ea,f=e.M.find(b.data.da);return h.ha(f,c,d),!1},T:function(f){Mustache.parse(h.cardTemplate),a.each(f,function(b,c){c.ia=e.options.ja;var d=a(Mustache.render(h.cardTemplate,c));h.ka(c.systemDate,c.tagDate),e.v.append(d)}),e.u=e.q.find(".sm-card"),h.la(),"timeline"===e.options.displayMode&&(h.g=new c),"grid"===e.options.displayMode&&(h.g=new d),h.ma(),h.na(),j.load(),i.L(),a(document).trigger("smFeedsLoaded");var g=new b(h.g);e.G.data("socialmix",g)},p:function(){e.q.find(".sm-dropdown-open").removeClass("sm-dropdown-open"),e.q.find(".sm-open-share-box").removeClass("sm-open-share-box")},ga:function(){return a(this).hasClass("sm-dropdown-open")?a(this).removeClass("sm-dropdown-open"):a(this).addClass("sm-dropdown-open"),!1},aa:function(){a(this).scrollTop()>100?e.q.find(".sm-scrollToTop").fadeIn():e.q.find(".sm-scrollToTop").fadeOut()},ca:function(){return a("html, body").animate({scrollTop:0},800),!1},goToDate:function(){var b=a(this).attr("value"),c=e.u.not(".sm-hidden").filter("."+b).eq(0);e.options.oneColumnHeight?e.q.animate({scrollTop:c.offset().top-100},800):a("html, body").animate({scrollTop:c.offset().top},800)},oa:function(a,b){var c=a.find("a[value='"+b+"']").html();a.find(".sm-dropdown-selected").html(c),h.p()},ha:function(b,c,d){h.oa(b,c);var f=e.u.filter(".sm-hidden").filter("."+d);return"all"!==c?(f=f.filter("."+c),f.removeClass(d)):f.removeClass(d),f.not(".filterSource").not(".filterTag").not(".filterDate").removeClass("sm-hidden"),"all"!==c&&(e.u.filter(".sm-hidden").not("."+c).addClass("sm-hidden "+d),e.u.not(".sm-hidden").not("."+c).addClass("sm-hidden "+d)),h.g.h(!0),e.M.find(".sm-goto a").hide(),e.u.not(".sm-hidden").each(function(){var b=a(this).attr("tag-date");e.M.find(".sm-goto a."+b).show()}),h.la(),!1},pa:function(b){var c="",d=b.type+"-"+b.id.replace("+","").replace(".","");"custom"!==b.type&&(c=a("<a value='source-"+d+"'><i class='sm-icon "+e.options.icons[b.type]+"'></i></a>")),e.M.find(".sm-filter-source .sm-dropdown-content").append(c)},qa:[],addCustomSourceFilter:function(b,c){if(a.inArray(b,h.qa)===-1){h.qa.push(b);var d=a("<a value='source-"+b+"'>"+c+"</a>");e.M.find(".sm-filter-source .sm-dropdown-content").append(d)}},ra:function(b,c,d){var f=a("<a value='"+c+"'><i class='sm-icon "+e.options.icons[b]+"'></i>"+d.name+"</a>");e.M.find(".sm-filter-source .sm-dropdown-content").append(f)},sa:function(b){if(!e.options.hideSourceFilter){h.W++;var c=a("<a value='source-"+h.W+"'><i class='sm-icon "+e.options.icons.rss+"'></i> "+b+"</a>");return e.M.find(".sm-filter-source .sm-dropdown-content").append(c),h.W}return 0},ka:function(a,b){if(this.Y.indexOf(b)===-1){this.Y.push(b);var c=e.q.find(".sm-goto .sm-dropdown-content"),d=e.q.find(".sm-filter-date .sm-dropdown-content"),g=f.ta(a);c.append("<a class='"+b+"' value='"+b+"'>"+g+"</option>"),d.append("<a class='"+b+"' value='"+b+"'>"+g+"</option>")}},ma:function(){if(e.options.sortCustomTag){var b={max:0,min:0};"desc"===e.options.sortCustomTagMode?(b.max=-1,b.min=1):"asc"===e.options.sortCustomTagMode&&(b.max=1,b.min=-1),this.X.sort(function(a,c){return a.name>c.name?b.max:b.min})}a.each(this.X,function(a,b){var c=e.q.find(".sm-filter-tag .sm-dropdown-content");c.append("<a  value='"+b.hash+"'>"+b.name+"</option>")})},populateTagList:function(b){var c=[];return a.each(b,function(a,b){var d=h.getTagData(b);c.push(d)}),c},getTagData:function(a){if(void 0===h.tags[a]){var b=h.Z,c="sm-tag-"+b;h.tags[a]=c,h.Z++;var d={name:a,hash:c};return h.X.push(d),d}return{name:a,hash:h.tags[a]}},na:function(){e.options.hideAllFilters?e.M.find(".sm-dropdown").remove():(e.M.show(),e.options.hideTagsFilters&&e.M.find(".sm-filter-tag").remove(),e.options.hideDateFilters&&e.M.find(".sm-filter-date").remove(),e.options.hideSourceFilter&&e.M.find(".sm-filter-source").remove(),e.options.hideGoToFilter&&e.M.find(".sm-goto").remove()),e.M.find(".sm-dropdown").each(function(){h.$+=a(this).outerWidth()}),e.q.find(".sm-loader").remove(),h.ba()},ua:function(a,b){var c=500,d=400,e=screen.width/2-c/2,f=screen.height/2-d/2;if(null==h.U||h.U.closed){var g="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+c+", height="+d+", top="+f+", left="+e;h.U=window.open(a,b,g)}else h.U.location.href=a,h.U.focus()},la:function(){var b=e.options.animation,c="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";e.u.not(".sm-hidden").slice(0,20).addClass("sm-"+b).one(c,function(){a(this).removeClass("sm-"+b)})},ba:function(){var a=e.q.width()-40;e.M.removeClass("sm-filter-container-boxed sm-filter-container-middle-boxed"),h.$>a&&(a<400?e.M.addClass("sm-filter-container-boxed"):e.M.addClass("sm-filter-container-middle-boxed"))}},i={L:function(){e.options.facebookAppId.length>1&&(window.fbAsyncInit=function(){FB.init({appId:e.options.facebookAppId,xfbml:!0,version:"v2.5"})},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk")),e.v.on("click",".sm-share-facebook",this.va),e.v.on("click",".sm-share-gplus",this.wa),e.v.on("click",".sm-share-twitter",this.xa),e.v.on("click",".sm-share-linkedin",this.ya)},va:function(){var b,c=a(this).attr("share-url");return b=e.options.facebookAppId.length>1?"https://www.facebook.com/dialog/share?app_id="+e.options.facebookAppId+"&display=popup&href="+c:"https://www.facebook.com/sharer/sharer.php?u="+c,h.ua(b,"sharepopup"),!1},ya:function(){var b=a(this).attr("share-url"),c="https://www.linkedin.com/shareArticle?mini=true&url="+b;h.ua(c,"sharepopup")},wa:function(){var b,c=a(this).attr("share-url"),d=a(this).parents(".sm-card");return b=d.hasClass("source-gplus")?c:"https://plus.google.com/share?url="+c,h.ua(b,"sharepopup"),!1},xa:function(){var b,c=a(this).attr("share-url"),d=a(this).parents(".sm-card");if(d.hasClass("source-twitter")){var e=d.attr("feed-id");b="https://twitter.com/intent/retweet?tweet_id="+e}else{var f=i.za(d);b="https://twitter.com/intent/tweet?text="+f+"&url="+c}return h.ua(b,"sharepopup"),!1},za:function(a){var b=a.find(".sm-title").text(),c=a.find(".sm-message-text").text(),d=a.find(".sm-text").text(),e="";return""!==b?e=b:""!==c?e=c:""!==d&&(e=d),e}},j={V:0,imgs:[],Aa:0,Ba:0,Ca:[],Da:0,load:function(){this.Ea()},Fa:function(){var b=e.u.find("iframe.sm-lazy").not(".sm-loaded").slice(0,1);if(1===b.length){var c=a(b).attr("data-src");a(b).attr("src",c),a(b).on("load",function(){a(this).addClass("sm-loaded"),j.Fa()}).on("error",function(){a(this).addClass("sm-loaded"),j.Fa()})}else a(document).trigger("smMediaLoaded")},Ga:function(){var a=e.u.find("video"),b=a.length,c=0;0===b&&j.Fa(),a.on("canplaythrough",function(){c++,b===c&&(h.g.h(!0),j.Fa())})},Ea:function(){var b=e.u.not(".sm-loaded").slice(0,5),c=b.find("img.sm-lazy");j.Ca=b,j.V=c.length,j.Aa=0,j.Ba=0,j.imgs=c,a.each(c,function(b,d){var e=a(d).attr("ini-src");a("<img/>").attr("src",e).on("load",function(){j.Ha(c)}).on("error",function(){j.Ha(c)})}),0===b.length?j.Ga():0===c.length&&j.Ia()},Ha:function(a){j.Aa++,j.Aa===j.V&&j.Ja(a)},Ja:function(b){b.on("load",j.Ka).on("error",j.La),a.each(b,function(b,c){var d=a(c),e=d.attr("ini-src");e&&d.attr("src",e)})},Ka:function(){a(this).parents(".sm-image-item").addClass("sm-loaded"),j.Ba++,j.Ma(a(this)),j.Ba===j.V&&j.Ia()},La:function(){j.Ba++,j.Ba===j.V&&j.Ia()},Ma:function(a){var b=e.options.carouselHeigth/3;(a.width()<b||a.height()<b)&&a.parents(".sm-image-item").remove()},Ia:function(){a.each(j.Ca,function(b,c){var d=a(c).addClass("sm-loaded"),f=d.find(".sm-image-box .sm-loaded img.sm-lazy");1===f.length?f.addClass("sm-single-img"):f.length>1&&(f.height(e.options.carouselHeigth),d.find(".sm-image-box").slick({Na:!0,speed:300,Oa:1,Pa:!0,Qa:!0,Ra:!0,Sa:!1,Ta:!0,prevArrow:"<div  class='slick-prev new'><i class='fa fa-angle-left'></i></div>",nextArrow:"<div  class='slick-next new'><i class='fa fa-angle-right'></i></div>"})),d.find(".sm-link-pop").magnificPopup({type:"image",image:{titleSrc:"data-title"}})}),h.g.h(!0),setTimeout(function(){j.Ea()},300)}},k={K:function(b){var c=e.options.dependencies,d=e.options.removeDependencies,f=e.options.basePath;this.Ua=0,this.Va=0,this.Wa=0,this.Xa=2,this.Ya=b;for(var g=0;g<c.js.length;g++){var h=c.js[g].name;a.inArray(h,d)===-1&&(this.Wa++,this.Za(f+c.js[g].src))}for(var i=0;i<c.css.length;i++){var j=c.css[i].name;a.inArray(j,d)===-1&&this.$a(f+c.css[i].src)}this._a()},Za:function(a){var b=this,c=document.createElement("script");c.type="text/javascript",c.src=a,c.onload=function(){b.Ua++,b.ab()},document.body.appendChild(c)},$a:function(b){a("<link>",{rel:"stylesheet",type:"text/css",href:b}).appendTo("head")},_a:function(){var b=this;a.get(e.options.basePath+e.options.cardTemplate,function(a){h.cardTemplate=a,b.Va++,b.ab()}),a.get(e.options.basePath+e.options.containerTemplate,function(a){h.containerTemplate=a,b.Va++,b.ab()})},ab:function(){this.Ua===this.Wa&&this.Va===this.Xa&&this.Ya()}};a.fn.socialmix.H={basePath:"",proxy:"",facebookAppId:"",bb:"updated",carouselHeigth:300,hideAllFilters:!1,hideTagsFilters:!0,hideDateFilters:!1,hideGoToFilter:!0,hideSourceFilter:!1,showCardCustomTags:!0,sortCustomTag:!0,sortCustomTagMode:"asc",oneColumnTimeline:!1,oneColumnHeight:"",fixOneColumnMode:!1,displayMode:"timeline",gridCardMinWidth:250,gridCardMargin:40,timelineCardMargin:40,timelineMinWidthTwoCol:650,animation:"fadeIn",sortCards:"desc",maxCardNumber:!1,momentLocale:"en",momentFormat:"MMMM D  YYYY, HH:mm ",momentSmallFormat:"MMMM D YYYY",dependencies:{js:[{name:"mustache",src:"asset/js/mustache.min.js"},{name:"anchorme",src:"asset/js/anchorme.min.js"},{name:"moment",src:"asset/js/moment-with-locales.min.js"},{name:"slick",src:"asset/js/slick.min.js"},{name:"lightbox",src:"asset/js/jquery.magnific-popup.min.js"}],css:[{name:"slick",src:"asset/css/slick.css"},{name:"font-awesome",src:"asset/css/font-awesome.min.css"},{name:"lightbox",src:"asset/css/magnific-popup.css"}]},removeDependencies:[],cardTemplate:"html/timeline_card.html",containerTemplate:"html/timeline_container.html",translate:{filterBy:"Filter By",filterByTag:"Filter by tag",allTags:"All Tags",goToDate:"Go to date",filterByDate:"Date",allDates:"All Dates",twitter:"Twitter",facebook:"Facebook",youtube:"Youtube",gplus:"Google +",allSources:"All Sources",filterBySource:"Source",vimeo:"Vimeo"},icons:{twitter:"fa fa-twitter-square",facebook:"fa fa-facebook-square",gplus:"fa fa-google-plus-square",rss:"fa fa-rss-square",youtube:"fa fa-youtube-square",vimeo:"fa fa-vimeo-square",event:"fa fa-calendar-check-o"}}}(jQuery),function(a){"use strict";a.fn.socialmix.I={L:function(){moment.locale(this.options.momentLocale)},O:function(a,b,c){if(a.customMapper)return a.customMapper.call(this,b,c,a);try{switch(a.type){case"facebook":return this.cb(b,c,a);case"twitter":return"search"===a.target?this.eb(b,c,a):this.fb(b,c,a);case"gplus":return this.gb(b,c,a);case"rss":return this.hb(b,c,a);case"youtube":return this.ib(b,c,a);case"vimeo":return this.jb(b,c,a);case"custom":case"custom_object":return this.kb(b,a);default:return[]}}catch(d){return console.error(a.type+" Error . Please check API-KEY in your settings file. Make sure the "+a.type+" api key is a valid API-KEY"),console.error(d),[]}},getTemplateManager:function(){return this.options.J},getSystemDate:function(a){var b=Date.parse(a);return isNaN(b)&&(b=Date.parse(a.replace(/( \+)/," UTC$1"))),isNaN(b)&&(b=Date.parse(a.replace(/-/g,"/").replace(/[TZ]/g," "))),moment(b)},dateFormat:function(a){return moment(a).format(this.options.momentFormat)},ta:function(a){return moment(a).format(this.options.momentSmallFormat)},tagDateFormat:function(a){return a.format("DD-MM-YYYY")},fixTextTag:function(a){return void 0===a||null===a?"":anchorme.js(a)},lb:function(a){var b,c,d,e;return c=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,b=a.replace(c,"<a href='$1' target='_blank'>$1</a>"),d=/(^|[^\/])(www\.[\S]+(\b|$))/gim,b=b.replace(d,"$1<a href='http://$2' target='_blank'>$2</a>"),e=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,b=b.replace(e,"<a href='mailto:$1'>$1</a>")},mb:function(a){return a.replace(/^\s+|\s+$/gm,"")},nb:function(b){var c="rel='nofollow'";a.each(b.entities.hashtags,function(a,d){var e="<a "+c+" href='https://twitter.com/hashtag/"+d.text+"' target='_blank'>#"+d.text+"</a>";b.text=b.text.replace("#"+d.text,e)}),a.each(b.entities.urls,function(a,d){var e="<a "+c+" href='"+d.url+"' target='_blank'>"+d.display_url+"</a>";b.text=b.text.replace(d.url,e)}),a.each(b.entities.user_mentions,function(a,d){var e="<a "+c+" href='http://twitter.com/"+d.screen_name+"' target='_blank'>"+d.screen_name+"</a>";b.text=b.text.replace(d.screen_name,e)})},kb:function(b){var c=this;return a.map(b,function(b){var d=c.getSystemDate(b.date),e=c.tagDateFormat(d),f=[];if(void 0!==b.tags&&(f=c.options.J.populateTagList(b.tags)),b.hasOwnProperty("imgs"))for(var g=b.imgs.length-1;g>=0;g--)b.imgs[g].hasOwnProperty("popSrc")||(b.imgs[g].popSrc=b.imgs[g].src);if(b.hasOwnProperty("youtubeVideos"))for(var h=0;h<b.youtubeVideos.length;h++){console.log(h);var i=b.youtubeVideos[h].id,j={src:"https://img.youtube.com/vi/"+i+"/0.jpg",popSrc:"http://youtube.com/watch?v="+i,type:"iframe",classes:"sm-video"};b.hasOwnProperty("imgs")||(b.imgs=[],console.log("reset")),b.imgs.push(j)}b.hasOwnProperty("titleLink")&&(b.originLink=b.ob);var k={source:"custom",fullDate:c.dateFormat(d),systemDate:d,text:c.fixTextTag(b.text),tags:f,tagDate:e};return a.extend(b,k),console.log(b),b})},cb:function(b,c,d){var e=this,f=b.posts?b.posts.data:[],g=b.events?b.events.data:[],h={name:b.name,link:b.link,avatar:b.picture.data.url},i="source-"+d.type+"-"+d.id;e.options.J.ra("facebook",i,h);var j=a.map(f,function(b){var d={};void 0!==b.attachments&&(d=b.attachments.data[0]);var f="";void 0!==b.story&&(f=b.story.replace(h.name,""));var g=void 0!==b.full_picture?[{src:b.full_picture,popSrc:b.full_picture,type:"image"}]:[];void 0!==d.subattachments&&(g=[],a.each(d.subattachments.data,function(a,b){var c=Object.keys(b.media);"image"===c[0]&&g.push({src:b.media[c[0]].src,popSrc:b.media[c[0]].src,type:"image"})}));var j=void 0!==b.message?b.message:"",k=void 0!==d.description?d.description:"";j===k&&(k="");var l="";void 0!==d.title?l=d.title:void 0!==b.title&&(l=b.title);var m=void 0!==b.embed_html?[{html:b.embed_html}]:[];if(d&&"video_inline"===d.type){b.full_picture===d.media.image.src&&(g=[]);var n="<div class='mfp-hide sm-pop sm-pop-"+b.id+"'><div class='fb-video' data-href='"+d.target.url+"' data-width='500' data-allowfullscreen='true'></div></div>";a("body").append(n),g.push({src:d.media.image.src,popSrc:".sm-pop-"+b.id,type:"inline",classes:"sm-video"})}if(d&&"video_share_youtube"===d.type){b.full_picture===d.media.image.src&&(g=[]);var o=decodeURIComponent(d.target.url),p=o.split(".php?u=")[1],q=p.split("&h=")[0];if(o.indexOf("attribution_link")>-1){var r=decodeURIComponent(q).split("/watch?v=")[1];q="http://youtube.com/watch?v="+r.split("&")[0]}g.push({src:d.media.image.src,popSrc:q,type:"iframe",classes:"sm-video"})}d&&"animated_image_share"===d.type&&(g=[],g.push({src:d.media.image.src,popSrc:b.link,type:"image",classes:"sm-gif"}));var s=h.link+"posts/"+b.id.split("_")[1],t=e.getSystemDate(b.created_time),u=e.tagDateFormat(t),v=[];return b.likes&&v.push({type:"likes",count:b.likes.summary.total_count,icon:"fa-thumbs-up"}),b.shares&&v.push({type:"share",count:b.shares.count,icon:"fa-share"}),b.comments&&v.push({type:"comments",count:b.comments.summary.total_count,icon:"fa-comment"}),{source:"facebook",sourceFilter:i,cardIcon:e.options.icons.facebook,id:b.id,fullDate:e.dateFormat(t),systemDate:t,link:s,message:e.lb(j),imgs:g,title:l,text:e.fixTextTag(k),user:h,sourceUser:{},action:f,originLink:b.link?b.link:s,embed:m,tags:c,tagDate:u,shares:v}}),k=a.map(g,function(b){var c=e.getSystemDate(b.start_time),d=!1,f=!1;if(b.end_time){var g=e.getSystemDate(b.end_time);f=moment.duration(g.diff(c)),d=e.dateFormat(g),f=f.humanize()}var j=e.tagDateFormat(c),k=[],l=[];b.cover&&(l.push({src:b.cover.source,popSrc:b.cover.source,type:"image"}),k.push(b.cover.id)),b.photos&&a.each(b.photos.data,function(a,b){var c=e.pb(b.images);c&&k.indexOf(b.id)===-1&&(l.push(c),k.push(b.id))});var m=[{title:"Attending",count:b.attending_count},{title:"Interested",count:b.interested_count}];return{source:"facebook",qb:"event",sourceFilter:i,id:b.id,originLink:"https://www.facebook.com/events/"+b.id,title:b.name,cardIcon:e.options.icons.facebook,fullDate:e.dateFormat(c),systemDate:c,tagDate:j,text:e.fixTextTag(b.description),imgs:l,user:h,shares:m,endDate:d,duration:f}});return a.merge(j,k)},pb:function(a){return a.length>0&&{src:a[0].source,popSrc:a[0].source,type:"image"}},eb:function(a,b,c){return this.fb(a.statuses,b,c)},fb:function(b,c,d){var e=this,f={name:b[0].user.screen_name,link:"https://twitter.com/"+b[0].user.screen_name,avatar:b[0].user.profile_image_url_https},g="source-"+d.type+"-"+d.id;return e.options.J.ra("twitter",g,f),a.map(b,function(b){e.nb(b);var d="",h={};void 0!==b.retweeted_status&&(d="RT",h={name:b.retweeted_status.user.screen_name,link:"https://twitter.com/"+b.retweeted_status.user.screen_name,avatar:b.retweeted_status.user.profile_image_url_https});var i=b.retweet_count,j=b.favorite_count;if(void 0!==b.retweeted_status){var k=b.retweeted_status.retweet_count,l=b.retweeted_status.favorite_count;i=Math.max(i,k),j=Math.max(j,l)}var m=[],n=[];void 0!==b.extended_entities&&void 0!==b.extended_entities.media&&a.each(b.extended_entities.media,function(c,d){if("animated_gif"===d.type||"video"===d.type){for(var e=d.video_info.variants,f={rb:-1,url:""},g={rb:-1,url:""},h=0;h<e.length;h++)"video/mp4"===e[h].content_type&&e[h].rb>g.rb&&(g=e[h]),"video/webm"===e[h].content_type&&e[h].rb>f.rb&&(f=e[h]);if(""!==f.url||""!==g){var i="<div class='mfp-hide sm-pop sm-pop-"+b.id_str+"'><video controls  name='media'><source src='"+f.url+"' type='video/webm'><source src='"+g.url+"' type='video/mp4'></video></div>";a("body").append(i),m.push({src:d.media_url_https,popSrc:".sm-pop-"+b.id_str,type:"inline",classes:"sm-video"})}else m.push({src:d.media_url_https,popSrc:d.media_url_https,type:"image"})}else m.push({src:d.media_url_https,popSrc:d.media_url_https,type:"image"})});var o=e.getSystemDate(b.created_at),p=e.tagDateFormat(o),q=e.dateFormat(o);return{source:"twitter",sourceFilter:g,cardIcon:e.options.icons.twitter,id:b.id_str,fullDate:q,systemDate:o,link:"https://twitter.com/statuses/"+b.id_str,message:"",imgs:m,title:"",text:b.text,user:f,sourceUser:h,action:d,originLink:"https://twitter.com/statuses/"+b.id_str,tags:c,tagDate:p,embed:n,shares:[{type:"retweet",count:i,icon:"fa-retweet"},{type:"favorite",count:j,icon:"fa-heart"}]}})},hb:function(b,c){var d=this,e=b.responseData.feed.link,f=a(b.responseData.xmlString),g=b.responseData.feed.type;g.match(/^rss*/)?f=f.filter("rss").find("channel"):g.match(/^atom.*/)&&(f=f.filter("feed"));var h=document.createElement("a");h.href=e;var i=h.hostname.replace("www.",""),j={name:i,link:e},k="source-rss-"+i;return k=k.replace(".",""),d.options.J.ra("rss",k,j),a.map(b.responseData.feed.entries,function(b,e){var h,i=a.map(a("<div>"+b.content+"</div>").find("img"),function(b){var c=a(b).attr("src"),d=/^((http|https|ftp):\/\/)/;if(d.test(c))return{src:c,popSrc:c,type:"image"}});h=g.match(/^rss*/)?f.find("item").eq(e):g.match(/^atom.*/)?f.find("entry").eq(e):a("<div/>"),h.find("[type*='image']").each(function(){i.push({src:a(this).attr("url"),popSrc:a(this).attr("url"),type:"image"})});for(var l=[],m=0;m<i.length;m++){var n=i[m].src.split("/"),o=n[n.length-1];void 0===l[o]?l[o]=i[m]:l[o].width<i[m].width&&(l[o]=i[m])}var p=[];for(var q in l)p.push(l[q]);var r=d.getSystemDate(b.publishedDate),s=d.tagDateFormat(r);return{source:"rss",sourceFilter:k,cardIcon:d.options.icons.rss,title:b.title,fullDate:d.dateFormat(r),systemDate:r,link:b.link,originLink:b.link,text:b.contentSnippet,user:j,imgs:p,tags:c,tagDate:s}})},gb:function(b,c,d){var e=this,f={name:b.items[0].actor.displayName,link:b.items[0].actor.url,avatar:b.items[0].actor.image.url},g="source-"+d.type+"-"+d.id;return g=g.replace("+",""),e.options.J.ra("gplus",g,f),a.map(b.items,function(b){var d={},h="";void 0!==b.object.attachments&&(d=b.object.attachments[0],h=void 0!==d.content?d.content:"");var i=e.mb(void 0!==b.object.content?b.object.content:""),j=e.mb(void 0!==d.displayName?d.displayName:"");if(i===h&&(h=""),(i===j||i.indexOf(j)>-1)&&(j=""),j.length>120){var k=j.substr(0,120),l=k.indexOf(" ")+120;j=j.substr(0,l)+" ..."}var m={},n="";void 0!==b.object.actor.displayName&&b.actor.id!==b.object.actor.id&&(n=b.sb,m={name:b.object.actor.displayName,link:b.object.actor.url,avatar:b.object.actor.image.url});var o=[];if(void 0!==d.image&&o.push({src:d.image.url,popSrc:d.image.url,type:"image"}),void 0!==d.thumbnails&&a.each(d.thumbnails,function(a,b){o.push({src:b.image.url,popSrc:b.image.url,type:"image"})}),void 0!==d.embed&&"video"===d.objectType){o=[];var p=d.embed.url.split("?")[0],q=p.replace("/v/","/watch?v=").replace("/embed/","/watch?v=");o.push({src:d.image.url,popSrc:q,type:"iframe",classes:"sm-video"})}var r=e.getSystemDate(b.published),s=e.tagDateFormat(r),t=b.object.url;return{source:"gplus",sourceFilter:g,cardIcon:e.options.icons.gplus,id:b.id,fullDate:e.dateFormat(r),systemDate:r,link:t,message:e.fixTextTag(i),imgs:o,title:j,text:e.fixTextTag(h),user:f,sourceUser:m,action:n,originLink:void 0!==d.url?d.url:t,embed:[],tags:c,tagDate:s,shares:[{type:"plusoners",count:b.object.plusoners.totalItems,icon:"fa-plus"},{type:"replies",count:b.object.replies.totalItems,icon:"fa-comment"}]}})},ib:function(b,c,d){var e=this,f=b.user,g="source-"+d.type+"-"+d.id;return g=g.replace("+",""),e.options.J.ra("youtube",g,f),a.map(b.items,function(a){var b=e.getSystemDate(a.snippet.publishedAt),d=e.tagDateFormat(b),h=a.contentDetails.videoId,i="http://www.youtube.com/watch?v="+h,j=[],k="https://www.youtube.com/watch?v="+h,l=[];l.push({src:a.snippet.thumbnails.medium.url,popSrc:i,type:"iframe",classes:"sm-video"});var m=a.snippet.description,n=350;if(m.length>350){var o=m.substr(0,n);o=o.substr(0,Math.min(o.length,o.lastIndexOf(" "))),m=o+" ..."}return{source:"youtube",sourceFilter:g,cardIcon:e.options.icons.youtube,id:a.id,fullDate:e.dateFormat(b),systemDate:b,link:k,message:"",imgs:l,title:a.snippet.title,text:e.fixTextTag(m),user:f,sourceUser:{},action:"",originLink:k,embed:j,tags:c,tagDate:d}})},jb:function(b,c,d){var e=this,f="source-"+d.type+"-"+d.id;if(b.data.length>0){var g={name:b.data[0].user.name};e.options.J.ra("vimeo",f,g)}return a.map(b.data,function(a){var b=e.getSystemDate(a.created_time),d=e.tagDateFormat(b),g=a.link,h=[],i=a.link,j=[];j.push({src:a.pictures.sizes[2].link,popSrc:g,type:"iframe",classes:"sm-video"});var k={name:a.user.name,link:a.user.link,avatar:a.user.pictures.sizes[2].link};return{source:"vimeo",sourceFilter:f,cardIcon:e.options.icons.vimeo,id:a.id,fullDate:e.dateFormat(b),systemDate:b,link:i,message:"",imgs:j,title:a.name,text:e.fixTextTag(a.description),user:k,sourceUser:{},action:"",originLink:i,embed:h,tags:c,tagDate:d}})}}}(jQuery);